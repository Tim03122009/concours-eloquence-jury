// --------------------------------------------------------------------------------
// FONCTION D'ADMINISTRATION : RÉINITIALISATION COMPLÈTE
// --------------------------------------------------------------------------------

window.confirmResetAllData = function() {
    // ... (Code de confirmation et de vérification)
    if (confirm("Êtes-vous ABSOLUMENT sûr de vouloir réinitialiser TOUTES les données du concours ? Cette action est irréversible et supprimera tous les scores de la base de données.")) {
        resetAllData();
    }
}

async function resetAllData() {
    try {
        // Étape 1 : SAUVEGARDER LES FICHIERS AVANT LA SUPPRESSION
        alert("Sauvegarde des résultats en cours. Veuillez patienter pour le téléchargement des deux fichiers...");
        await loadAllScores(false); 
        
        exportToExcel();
        exportPodiumToImage();

        await new Promise(r => setTimeout(r, 2000)); 


        // Étape 2 : SUPPRIMER TOUS LES SCORES DE FIREBASE
        const scoresRef = collection(db, "scores");
        const snapshot = await getDocs(scoresRef);
        
        const deletePromises = [];
        snapshot.forEach(docData => {
            deletePromises.push(deleteDoc(doc(db, "scores", docData.id)));
        });

        await Promise.all(deletePromises);
        console.log("Tous les scores ont été supprimés de Firebase.");


        // Étape 3 : EFFACER L'AFFICHAGE ET LE STOCKAGE LOCAL DE L'ADMIN
        
        // Nettoyage de l'affichage
        document.getElementById('scores-matrix').querySelector('tbody').innerHTML = '';
        document.getElementById('podium-body').innerHTML = '';
        document.getElementById('total-candidates').textContent = 'Total de candidats évalués : 0';

        // NETTOYAGE CRITIQUE POUR TES TESTS : Suppression de ton nom de jury
        // Cela t'oblige à te reconnecter pour tes prochains tests
        localStorage.clear(); 
        
        alert("RÉINITIALISATION COMPLETE RÉUSSIE ! Tous les scores ont été supprimés et VOTRE navigateur a été remis à zéro. (Pour les jurys, ils devront simplement actualiser leur page pour une nouvelle session).");

    } catch (error) {
        console.error("Erreur lors de la réinitialisation des données :", error);
        alert("Erreur lors de la réinitialisation. Vérifiez la console.");
    }
}
// Le reste du code...